(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[790],{66965:(e,s,t)=>{Promise.resolve().then(t.bind(t,74286))},74286:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(45474),n=t(71530),l=t(68564),r=t(28747);t(77560);var c=t(39949),i=t(1457),o=t(59188);let d=(0,o.A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),x=(0,o.A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var h=t(37126),m=t(1372);let g=(0,o.A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),u=(0,o.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),p=(0,o.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),j=(0,o.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var b=t(41551);let v=e=>{var s,t,n;let{transaction:l,onBack:o}=e,d="success"===l.status||0===(null===(s=l.tx_result)||void 0===s?void 0:s.code);return(0,a.jsx)("div",{className:"bg-gray-900 rounded-lg shadow-md overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"flex items-center mb-6",children:(0,a.jsxs)("button",{onClick:o,className:"flex items-center text-blue-500 hover:text-blue-400 transition-colors",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Transactions"]})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-white mb-6",children:"Transaction Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Transaction Hash"})]}),(0,a.jsx)("p",{className:"text-white break-all font-mono text-sm",children:l.hash})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Time"})]}),(0,a.jsx)("p",{className:"text-white",children:(0,b.Yq)(l.time||l.timestamp||"")})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)("span",{className:"mr-2",children:"#"}),(0,a.jsx)("span",{children:"Block"})]}),(0,a.jsx)("p",{className:"text-white",children:l.height})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center text-gray-400 mb-1",children:(0,a.jsx)("span",{className:"mr-2",children:"Status"})}),(0,a.jsx)("div",{className:"flex items-center",children:d?(0,a.jsxs)("span",{className:"flex items-center px-3 py-1 rounded-full bg-green-900 text-green-300",children:[(0,a.jsx)(r.A,{className:"h-4 w-4 mr-1"}),"Success"]}):(0,a.jsxs)("span",{className:"flex items-center px-3 py-1 rounded-full bg-red-900 text-red-300",children:[(0,a.jsx)(g,{className:"h-4 w-4 mr-1"}),"Failed"]})})]}),l.fee&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Fee"})]}),(0,a.jsx)("p",{className:"text-white",children:l.fee})]}),(null===(t=l.tx_result)||void 0===t?void 0:t.gas_used)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center text-gray-400 mb-1",children:(0,a.jsx)("span",{className:"mr-2",children:"Gas"})}),(0,a.jsxs)("p",{className:"text-white",children:[l.tx_result.gas_used," / ",l.tx_result.gas_wanted||"unknown"]})]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-800 pt-6 mt-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-white mb-4",children:"Transaction Data"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.from&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"From"})]}),(0,a.jsx)("p",{className:"text-white break-all font-mono text-sm",children:l.from})]}),l.to&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(p,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"To"})]}),(0,a.jsx)("p",{className:"text-white break-all font-mono text-sm",children:l.to})]})]}),l.amount&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Amount"})]}),(0,a.jsx)("p",{className:"text-white",children:l.amount})]}),(null===(n=l.tx_result)||void 0===n?void 0:n.log)&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400 mb-1",children:[(0,a.jsx)(j,{className:"h-4 w-4 mr-2"}),(0,a.jsx)("span",{children:"Log"})]}),(0,a.jsx)("div",{className:"bg-gray-800 p-4 rounded-md overflow-auto",children:(0,a.jsx)("pre",{className:"text-gray-300 text-sm whitespace-pre-wrap",children:l.tx_result.log})})]})]})]})})};function f(){return(0,a.jsx)(n.Suspense,{fallback:(0,a.jsx)("div",{className:"text-center py-10",children:"Loading transactions..."}),children:(0,a.jsx)(N,{})})}function N(){let[e,s]=(0,n.useState)([]),[t,r]=(0,n.useState)(!0),[o,m]=(0,n.useState)(null),[g,u]=(0,n.useState)(null),[p,j]=(0,n.useState)(!1),[b,f]=(0,n.useState)(null),[N,y]=(0,n.useState)(null),[w,k]=(0,n.useState)(null),[_,S]=(0,n.useState)(null),[I,T]=(0,n.useState)(null),[A,C]=(0,n.useState)(1),[M,z]=(0,n.useState)(10),[F,E]=(0,n.useState)(0),[L,H]=(0,n.useState)([]),[P,q]=(0,n.useState)(50),[B,D]=(0,n.useState)(""),O=(0,l.useRouter)(),R=(0,l.useSearchParams)(),U=(0,l.usePathname)();(0,n.useEffect)((()=>{let s=R.get("tx"),t=R.get("page"),a=R.get("per_page"),n=R.get("blocks");if(t&&C(parseInt(t)),a&&z(parseInt(a)),n){let e=parseInt(n);!isNaN(e)&&e>0&&q(e)}if(s){let t=e.find((e=>e.hash===s));t?W(t):u(null)}else u(null)}),[R]),(0,n.useEffect)((()=>{let e=sessionStorage.getItem("zigchain_transactions"),s=sessionStorage.getItem("zigchain_tx_page"),t=sessionStorage.getItem("zigchain_tx_per_page"),a=sessionStorage.getItem("zigchain_tx_max_blocks");if(e)try{let n=JSON.parse(e);H(n),E(n.length),V(n),console.log("[Transactions] Restored transactions from session storage"),s&&C(parseInt(s)),t&&z(parseInt(t)),a&&q(parseInt(a))}catch(e){console.error("[Transactions] Error parsing saved transactions:",e),J(P)}else J(P)}),[]),(0,n.useEffect)((()=>{P>0&&J(P)}),[P]),(0,n.useEffect)((()=>{V()}),[A,M,L]);let J=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{r(!0),m(null),console.log("[Transactions] Fetching ".concat(e," latest transactions from API"));let s=await(0,h.rX)(e);console.log("[Transactions] Found ".concat(s.length," transactions")),H(s),E(s.length),sessionStorage.setItem("zigchain_transactions",JSON.stringify(s)),sessionStorage.setItem("zigchain_tx_page",A.toString()),sessionStorage.setItem("zigchain_tx_per_page",M.toString()),sessionStorage.setItem("zigchain_tx_max_blocks",P.toString()),V(s)}catch(e){console.error("[Transactions] Error fetching transactions:",e),m("Failed to fetch transactions. Please try again later.")}finally{r(!1)}},V=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=(A-1)*M,a=Math.min(t+M,e.length);s(e.slice(t,a))},W=async e=>{try{var s,t,a,n,l;j(!0),f(null),console.log("[Transactions] Fetching details for transaction ".concat(e.hash));let r=await(0,h.AL)(e.hash);if(r){console.log("[Transactions] Transaction details:",r);let l=r.status||(0===r.code||0===(null===(s=r.tx_result)||void 0===s?void 0:s.code)?"success":"failed"),c={...r,hash:r.hash,height:(null===(t=r.height)||void 0===t?void 0:t.toString())||(null===(a=e.height)||void 0===a?void 0:a.toString())||"0",time:r.timestamp||r.time||e.created_at||"",from:r.from||e.from||"",to:r.to||e.to||"",amount:r.amount||e.amount||"",fee:r.fee||"",status:l,tx_result:r.tx_result||{code:+(0!==r.code),data:"",log:"",gas_wanted:"",gas_used:"",events:[]}};u(c),y(c.from||""),k(c.to||""),S(c.amount||"");let i=c.fee||((null===(n=c.tx_result)||void 0===n?void 0:n.gas_used)?"".concat(c.tx_result.gas_used," gas"):"Unknown");T(i)}else{console.log("[Transactions] No detailed data available, using basic transaction data");let s=e.status||(0===e.code||0===(null===(l=e.tx_result)||void 0===l?void 0:l.code)?"success":"failed");u({...e,status:s,tx_result:e.tx_result||{code:+(0!==e.code),data:"",log:"",gas_wanted:"",gas_used:"",events:[]}}),y(e.from||""),k(e.to||""),S(e.amount||""),T("Unknown")}}catch(e){console.error("Error fetching transaction details:",e),f("Failed to fetch transaction details. Please try again later.")}finally{j(!1)}},X=s=>{O.push("".concat(U,"?tx=").concat(s).concat(A>1?"&page=".concat(A):"").concat(25!==M?"&per_page=".concat(M):"").concat(50!==P?"&blocks=".concat(P):"")),sessionStorage.setItem("txReferrer","/transactions");let t=e.find((e=>e.hash===s));t&&W(t)},G=e=>{C(e),O.push("".concat(U,"?page=").concat(e,"&per_page=").concat(M,"&blocks=").concat(P))},Y=e=>{z(e),C(1),O.push("".concat(U,"?page=1&per_page=").concat(e,"&blocks=").concat(P))},Z=e=>new Date(e).toLocaleString(),K=function(e){return e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"0x".concat(e):e.length>16?"0x".concat(e.substring(0,8),"...").concat(e.substring(e.length-8)):e:""};return(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-16",children:"Transactions"}),t&&(0,a.jsx)("div",{className:"space-y-4",children:[...Array(10)].map(((e,s)=>(0,a.jsxs)("div",{className:"dark:bg-gray-800 rounded-lg shadow-md p-4 animate-pulse",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-1/4"}),(0,a.jsx)("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-1/6"})]}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/3 mt-3"})]},s)))}),o&&(0,a.jsxs)("div",{className:"bg-red-900 text-red-100 p-4 rounded-lg shadow-md",children:[(0,a.jsx)("p",{className:"font-semibold",children:"Error loading transactions:"}),(0,a.jsx)("p",{children:o})]}),!t&&!o&&(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6",children:g?(0,a.jsx)(v,{transaction:g,onBack:()=>{u(null),f(null),O.push("".concat(U).concat(A>1?"?page=".concat(A):"").concat(25!==M&&A>1?"&per_page=".concat(M):25!==M&&1===A?"?per_page=".concat(M):"").concat(50!==P&&A>1?"&blocks=".concat(P):50!==P&&1===A?"?blocks=".concat(P):""))}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"space-y-4 mb-6",children:e.map((e=>(0,a.jsx)("div",{className:"px-6 py-4 bg-[#1e2939] rounded-lg hover:bg-gray-700/30 transition-colors",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"mr-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-full",children:(0,a.jsx)(c.A,{size:20,className:"text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>X(e.hash),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-lg font-semibold transition-colors",children:[(0,a.jsx)("span",{className:"hidden lg:inline",title:e.hash,children:K(e.hash,!0)}),(0,a.jsx)("span",{className:"inline lg:hidden",title:e.hash,children:K(e.hash)})]}),(0,a.jsxs)("div",{className:"flex items-center text-gray-500 dark:text-gray-400 text-sm mt-1",children:[(0,a.jsx)(i.A,{size:14,className:"mr-1"}),(0,a.jsx)("span",{children:Z(e.time||e.created_at||e.timestamp||"")})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 items-center",children:[(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("success"===e.status||0===e.code?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300"),children:"success"===e.status||0===e.code?"Success":"Failed"}),(0,a.jsx)("button",{onClick:()=>X(e.hash),className:"text-xs font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:"View Details"})]})]})},e.hash)))}),(0,a.jsx)("div",{className:"mt-16",children:(0,a.jsx)("div",{className:"flex justify-center items-center mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center md:mx-auto md:justify-between md:flex-row flex-col md:space-x-4 md:space-y-0 space-y-4 md:text-left text-center",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>G(1),disabled:1===A,className:"p-1 rounded ".concat(1===A?"text-gray-500 cursor-not-allowed":"text-gray-300 hover:bg-gray-700"),"aria-label":"First page",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("polyline",{points:"11 17 6 12 11 7"}),(0,a.jsx)("polyline",{points:"18 17 13 12 18 7"})]})}),(0,a.jsx)("button",{onClick:()=>G(A-1),disabled:1===A,className:"p-1 rounded ".concat(1===A?"text-gray-500 cursor-not-allowed":"text-gray-300 hover:bg-gray-700"),"aria-label":"Previous page",children:(0,a.jsx)(d,{className:"h-5 w-5"})}),(0,a.jsx)("div",{className:"flex items-center mx-3 px-3 py-1 bg-gray-700 rounded",children:(0,a.jsxs)("span",{className:"text-sm text-gray-200",children:["Page ",(0,a.jsx)("span",{className:"font-bold",children:A})," of ",(0,a.jsx)("span",{className:"font-bold",children:Math.max(1,Math.ceil(F/M))})]})}),(0,a.jsx)("button",{onClick:()=>G(A+1),disabled:A>=Math.ceil(F/M),className:"p-1 rounded ".concat(A>=Math.ceil(F/M)?"text-gray-500 cursor-not-allowed":"text-gray-300 hover:bg-gray-700"),"aria-label":"Next page",children:(0,a.jsx)(x,{className:"h-5 w-5"})}),(0,a.jsx)("button",{onClick:()=>G(Math.ceil(F/M)),disabled:A>=Math.ceil(F/M),className:"p-1 rounded ".concat(A>=Math.ceil(F/M)?"text-gray-500 cursor-not-allowed":"text-gray-300 hover:bg-gray-700"),"aria-label":"Last page",children:(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("polyline",{points:"13 17 18 12 13 7"}),(0,a.jsx)("polyline",{points:"6 17 11 12 6 7"})]})})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-300",children:"Items per page:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>Y(10),className:"px-2 py-1 text-xs hover:cursor-pointer rounded ".concat(10===M?"bg-blue-600 text-white":" text-gray-300 hover:bg-gray-700"),children:"10"}),(0,a.jsx)("button",{onClick:()=>Y(25),className:"px-2 py-1 text-xs hover:cursor-pointer rounded ".concat(25===M?"bg-blue-600 text-white":" text-gray-300 hover:bg-gray-700"),children:"25"}),(0,a.jsx)("button",{onClick:()=>Y(50),className:"px-2 py-1 text-xs hover:cursor-pointer rounded ".concat(50===M?"bg-blue-600 text-white":" text-gray-300 hover:bg-gray-700"),children:"50"})]})]})]})})}),0===e.length&&!t&&!o&&(0,a.jsx)("div",{className:"text-center py-10 bg-gray-900 rounded-lg shadow-md",children:(0,a.jsx)("p",{className:"text-gray-400",children:"No transactions found"})})]})})]})}}},e=>{e.O(0,[223,765,358],(()=>(s=>e(e.s=s))(66965))),_N_E=e.O()}]);